<div class="journal-container">
  <div class="journal-header">
    <h1>Diario de Emociones</h1>
    <p>Un espacio seguro para registrar tus sentimientos y reflexionar sobre tus interacciones.</p>
    <button class="add-entry-btn" (click)="isFormVisible = !isFormVisible">
      {{ isFormVisible ? 'Cerrar Formulario' : 'Añadir Nueva Entrada' }}
    </button>
  </div>

  <div *ngIf="isFormVisible" class="form-container">
    <form [formGroup]="journalForm" (ngSubmit)="onSubmit()">
      <div class="form-field">
        <label for="title">Título de la entrada</label>
        <input id="title" type="text" formControlName="title" placeholder="Ej: Discusión sobre las tareas">
      </div>

      <!-- --- SECCIÓN DE EMOCIONES REDISEÑADA --- -->
      <div class="form-field">
        <label>¿Qué emociones principales sentiste?</label>
        <div class="emotion-options">
          <button 
            type="button"
            *ngFor="let emotion of emotions"
            class="emotion-tag-option"
            [class.selected]="isSelected(emotion)"
            (click)="toggleEmotion(emotion)">
            {{ emotion }}
          </button>
        </div>
      </div>

      <div class="form-field">
        <label for="description">Describe la situación</label>
        <textarea id="description" formControlName="description" rows="5" placeholder="¿Qué pasó? ¿Cómo te sentiste? ¿Qué hiciste?"></textarea>
      </div>
      <button type="submit" class="submit-btn" [disabled]="journalForm.invalid">Guardar Entrada</button>
    </form>
  </div>

  <div class="entries-list">
    <div *ngIf="userService.journalEntries().length > 0; else noEntries">
      <div *ngFor="let entry of userService.journalEntries()" class="entry-card">
        <div class="entry-card-header">
          <h3>{{ entry.title }}</h3>
          <span class="entry-date">{{ entry.date | date:'d MMMM, yyyy' }}</span>
        </div>
        <div class="entry-card-body">
          <p>{{ entry.description }}</p>
        </div>
        <!-- --- VISUALIZACIÓN DE MÚLTIPLES EMOCIONES --- -->
        <div class="entry-card-footer">
          <span *ngFor="let emotion of entry.emotions" class="emotion-tag">{{ emotion }}</span>
        </div>
      </div>
    </div>
    <ng-template #noEntries>
      <div class="no-entries-placeholder">
        <p>Tu diario está vacío.</p>
        <span>¡Crea tu primera entrada para empezar a reflexionar sobre tu viaje!</span>
      </div>
    </ng-template>
  </div>
</div>
